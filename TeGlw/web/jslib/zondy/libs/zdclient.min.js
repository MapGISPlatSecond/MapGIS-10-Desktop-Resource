window.Zondy={},Zondy.Map=OpenLayers.Class(Zondy,{}),Zondy.Service=OpenLayers.Class(Zondy,{}),Zondy.Service.Catalog=OpenLayers.Class(Zondy.Service,{}),Zondy.Object=OpenLayers.Class(Zondy,{}),Zondy.Format=OpenLayers.Class(Zondy,{}),Zondy.Util=OpenLayers.Class(Zondy,{}),Zondy.Control=OpenLayers.Class(Zondy,{}),Zondy.Util.Hashtable=OpenLayers.Class({items:new Array,itemsCount:0,initialize:function(){},add:function(a,b){if(this.containsKey(a))throw"key '"+a+"'已经存在";this.items[a]=b,this.itemsCount++},get:function(a){return this.containsKey(a)?this.items[a]:null},remove:function(a){if(!this.containsKey(a))throw"key '"+a+"' does not exists.";delete this.items[a],this.itemsCount--},containsKey:function(a){return"undefined"!=typeof this.items[a]},containsValue:function(a){for(var b in this.items)if(this.items[b]==a)return!0;return!1},contains:function(a){return this.containsKey(a)||this.containsValue(a)},clear:function(){this.items=new Array,itemsCount=0},size:function(){return this.itemsCount},isEmpty:function(){return 0==this.size()}}),Zondy.ATT_STURCT_CACHE=new Zondy.Util.Hashtable,Zondy.Enum={},Zondy.Enum.FeatureType={},Zondy.Enum.FeatureType.Unknown=0,Zondy.Enum.FeatureType.Pnt=1,Zondy.Enum.FeatureType.Lin=2,Zondy.Enum.FeatureType.Reg=3,Zondy.Enum.LabelLinType={},Zondy.Enum.LabelLinType.Curved=0,Zondy.Enum.LabelLinType.Forward=1,Zondy.Enum.LabelLinType.Horizontal=2,Zondy.Enum.LabelLinType.Tangent=3,Zondy.Enum.LabelRegType={},Zondy.Enum.LabelRegType.Curved=0,Zondy.Enum.LabelRegType.Forward=1,Zondy.Enum.LabelRegType.Horizontal=2,Zondy.Enum.LabelRegType.Boundray=3,Zondy.Enum.LabelRegType.Outside=4,Zondy.Enum.LabelPntType={},Zondy.Enum.LabelPntType.PntAnyDir=0,Zondy.Enum.LabelPntType.PntEightDir=1,Zondy.Enum.LabelPntType.PntOnFea=2,Zondy.Enum.RepeatType={},Zondy.Enum.RepeatType.Auto=0,Zondy.Enum.RepeatType.NoRep=1,Zondy.Enum.RepeatType.OnStep=2,Zondy.Enum.LabelSpreadType={},Zondy.Enum.LabelSpreadType.AutoSpread=0,Zondy.Enum.LabelSpreadType.Centralization=1,Zondy.Enum.LabelSpreadType.Decentralization=2,Zondy.Enum.LineConstrain={},Zondy.Enum.LineConstrain.Left=0,Zondy.Enum.LineConstrain.Right=1,Zondy.Enum.LineConstrain.Above=2,Zondy.Enum.LineConstrain.Below=3,Zondy.Enum.LineConstrain.Both=4,Zondy.Enum.LineConstrain.NoRes=5,Zondy.Enum.EightDirType={},Zondy.Enum.EightDirType.East=0,Zondy.Enum.EightDirType.North=1,Zondy.Enum.EightDirType.NorthEast=2,Zondy.Enum.EightDirType.NorthWest=3,Zondy.Enum.EightDirType.South=4,Zondy.Enum.EightDirType.SouthEast=5,Zondy.Enum.EightDirType.SouthWest=6,Zondy.Enum.EightDirType.West=7,Zondy.Enum.EightDirType.NoDir=8,Zondy.Enum.ISShowArc={},Zondy.Enum.ISShowArc.Reg=0,Zondy.Enum.ISShowArc.Arc=1,Zondy.Enum.ISShowArc.All=2,Zondy.Enum.TianDiTu={},Zondy.Enum.TianDiTu.Vecotr=0,Zondy.Enum.TianDiTu.Raster=1,Zondy.Enum.TianDiTu.Annotation=2,jQuery.extend({evalJSON:function(strJson){return eval("("+strJson+")")}}),jQuery.extend({toJSON:function(a,b,c,d){var e,f,g,h,i;if(null==a)return null;switch(e=typeof a,"object"==e&&(e=Array==a.constructor?"array":RegExp==a.constructor?"regexp":"object"),e){case"undefined":case"unknown":return;case"function":return;case"boolean":case"regexp":return a.toString();case"number":return isFinite(a)?a.toString():"null";case"string":return d||void 0==d?'"'+a.replace(/(\\|\")/g,"\\$1").replace(/\n|\r|\t/g,function(){var a=arguments[0];return"\n"==a?"\\n":"\r"==a?"\\r":"	"==a?"\\t":""})+'"':a;case"object":if(null===a)return"null";f=[];for(g in a)void 0!=b|null!=b&&$.inArray(g,b)>-1||(h=jQuery.toJSON(a[g],null,null,d),void 0!==h&&f.push(jQuery.toJSON(g,null,null,d)+":"+h));return void 0!=c?"{"+f.join(c)+"}":"{"+f.join(",")+"}";case"array":for(f=[],i=0;i<a.length;i++)h=jQuery.toJSON(a[i],null,null,d),void 0!==h&&(null==h&&(h="null"),f.push(h));return"["+f.join(",")+"]"}}}),Zondy.Util.getTopAnalysisResult=function(a){switch(a){case 0:return"Intersect";case 1:return"Disjoin";case 2:return"Include";case 3:return"Adjacent";default:return"Unknown"}},Zondy.Util.newGuid=function(){var b,c,a="";for(b=1;32>=b;b++)c=Math.floor(16*Math.random()).toString(16),a+=c,(8==b||12==b||16==b||20==b)&&(a+="-");return a},Zondy.Util.objectDeleteUnuseful=function(a,b){return $.each(b,function(b,c){delete a[c]}),a},Zondy.Util.toUrlParameters=function(a){if(a){var b="";return $.each(a,function(a,c){b=b+"&"+a+"="+c}),b=b.substring(1,b.length)}return""},Zondy.Service.HttpRequest=OpenLayers.Class({ip:"localhost",port:"6163",baseUrl:null,partUrl:null,initialize:function(){},ajax:function(a,b,c,d,e,f){var h,i;null==a&&(a="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/"+this.partUrl),$.support.cors=!0,void 0==d&&(d="GET"),"POST"==d.toUpperCase()&&"object"==typeof b&&(h=$.toJSON(b),b=h),(void 0==e||null==e)&&(e=null!=b&&"POST"==d.toUpperCase()?"text/plain":"application/x-www-form-urlencoded"),i=this.analysisResultType(f),""!=OpenLayers.ProxyHost?this.ajaxForProxy(a,b,c,d,e,i):this.ajaxNormal(a,b,c,d,e,i)},analysisCrossDomain:function(a){if(a.indexOf("http")<0&&a.indexOf("https")<0)return!1;var b=window.location.protocol+"://"+window.location.host;return 0==a.indexOf(b)?!1:!0},analysisResultType:function(a){return a?"json"!=a?"text":a:"json"},ajaxForProxy:function(a,b,c,d,e,f){var h,i,g=OpenLayers.ProxyHost;"GET"==d.toUpperCase()?b={url:a+"?"+Zondy.Util.toUrlParameters(b)}:g+="?url="+encodeURI(a),h=this,i={type:d,url:g,dataType:f,data:b,context:h,contentType:e,success:function(a){c.call(this,a)},error:function(){alert("请求失败，请检查参数")}},$.ajax(i)},ajaxNormal:function(a,b,c,d,e,f){var i,g=this,h=this.analysisCrossDomain(a);$.browser.msie&&window.XDomainRequest&&h?this.ajaxForIE(a,b,c,d,g,f):(i={type:d,url:a,dataType:f,data:b,context:g,contentType:e,success:function(a){c.call(this,a)},error:function(){alert("请求失败，请检查参数")}},$.ajax(i))},ajaxForIE:function(a,b,c,d,e,f){var h,g=new XDomainRequest;if("GET"==d.toUpperCase()){if(h="",b){for(key in b)h=h+"&"+key+"="+b[key];h=h.substring(1,h.length),a.contains("?")?a+=h:a=a+"?"+h}a=decodeURI(a),a=encodeURI(a),g.open("get",a),g.onload=function(){var a;a="text"!=f?$.parseJSON(this.responseText):this.responseText,c.call(e,a)},g.send()}"POST"==d.toUpperCase()&&(a=decodeURI(a),a=encodeURI(a),g.open("post",a),g.send(b),g.onload=function(){c(g.responseText,"success")})}}),Zondy.Service.DocLayer=OpenLayers.Class({mapName:null,layerIndex:null,mapIndex:0,initialize:function(){}}),Zondy.Map.Doc=OpenLayers.Class(OpenLayers.Layer.Grid,Zondy.Service.HttpRequest,{reproject:!1,isBaseLayer:!0,encodeBBOX:!1,docName:null,f:"png",layers:null,filters:null,style:null,proj:null,cache:!1,update:!1,cacheBox:null,p_cacheOrigin:null,cacheWidth:256,cacheHeight:256,guid:null,initialize:function(a,b,c){var e,f,d=[];null==this.baseUrl&&(this.baseUrl="igs/rest/mrms"),null==this.partUrl&&(this.partUrl="docs"),OpenLayers.Util.extend(this,c),e="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/"+this.partUrl+"/"+b,f={},d.push(a,e,f,{}),OpenLayers.Layer.Grid.prototype.initialize.apply(this,d),null!=c&&0==c.isBaseLayer&&(this.isBaseLayer=!1),null==this.guid&&(this.guid=Zondy.Util.newGuid()),this.cache||(this.singleTile=!0)},setDocUniqueName:function(a){this.guid=a},getDocUniqueName:function(){return this.guid},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){return null==a&&(a=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},reverseAxisOrder:function(){return parseFloat(this.params.VERSION)>=1.3&&!!this.yx[this.map.getProjectionObject().getCode()]},getURL:function(a){var c,d,e,f,b={};return b.f=this.f,b.cache=this.cache,a=this.adjustBounds(a),this.cache?(null==this.cacheBox&&(this.cacheBox=this.map.maxExtent),null==this.p_cacheOrigin&&(this.p_cacheOrigin=new OpenLayers.LonLat(this.cacheBox.left,this.cacheBox.bottom)),c=this.map.getResolution(),b.col=Math.round((a.left-this.p_cacheOrigin.lon)/(c*this.tileSize.w)),b.row=Math.round((a.bottom-this.p_cacheOrigin.lat)/(c*this.tileSize.h)),b.level=this.getZoomForResolution(c,!0),b.w=this.cacheWidth,b.h=this.cacheHeight,b.bbox=this.map.maxExtent.toString(),b.update=this.update):(d=this.getImageSize(),e=this.reverseAxisOrder(),b.bbox=this.encodeBBOX?a.toBBOX(null,e):a.toArray(e),b.w=d.w,b.h=d.h,b.filters=this.filters,b.layers=this.layers,b.style=$.toJSON(this.style),b.proj=$.toJSON(this.proj),b.guid=this.guid),f=this.getFullRequestString(b)},mergeNewParams:function(a){var b=OpenLayers.Util.upperCaseObject(a),c=[b];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,c)},getFullRequestString:function(a){return"boolean"==typeof this.params.TRANSPARENT&&(a.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"Zondy.Map.Doc"}),Zondy.Map.TileLayer=OpenLayers.Class(OpenLayers.Layer.Grid,Zondy.Service.HttpRequest,{serviceVersion:"1.0.0",isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,hdfName:null,compress:!1,rate:1,initialize:function(a,b,c){var d=[];this.hdfName=b,d.push(a,null,{},c),OpenLayers.Layer.Grid.prototype.initialize.apply(this,d),null==this.baseUrl&&(this.baseUrl="igs/rest/mrms")},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){return null==a&&(a=new Zondy.Map.TileLayer(this.name,this.hdfName,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var b,c,d,e,f,g;return a=this.adjustBounds(a),b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),d=Math.round((a.bottom-this.tileOrigin.lat)/(b*this.tileSize.h)),0>d&&(d=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h))),e=this.getZoomForResolution(b,!0)+this.zoomOffset,f="/"+this.hdfName+"/"+e+"/"+d+"/"+c,g="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/"+"tile",g instanceof Array&&(g=this.selectUrl(f,g)),g+f},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TileLayer"}),Zondy.Map.TianDiTu=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,layerType:Zondy.Enum.TianDiTu.Vecotr,url:"http://tile0.tianditu.com/DataServer",initialize:function(a,b){var c,d;$.extend(this,b),c=this.url,d=[],d.push(a,c,{},{}),OpenLayers.Layer.Grid.prototype.initialize.apply(this,d)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments)},clone:function(a){return null==a&&(a=new OpenLayers.Layer.TileLayer(this.name,this.url,this.getOptions())),a=OpenLayers.Layer.Grid.prototype.clone.apply(this,[a])},getURL:function(a){var b,c,d,e;return a=this.adjustBounds(a),b=this.map.getResolution(),c=Math.round((a.left-this.tileOrigin.lon)/(b*this.tileSize.w)),d=Math.round((this.tileOrigin.lat-a.top)/(b*this.tileSize.h)),0>d&&(d=Math.abs(d)),e=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,b):this.map.getZoom()+this.zoomOffset,this.getTiandiUrl(this.layerType,c,d,e)},getTiandiUrl:function(a,b,c,d){var f,e="";switch(a){case 0:e="A0512_EMap",d>=2&&10>=d&&(e="A0512_EMap"),d>10&&12>=d&&(e="B0627_EMap1112"),d>12&&18>=d&&(e="siwei0608");break;case 1:e="sbsm0210",11==d&&(e="e11"),12==d&&(e="e12"),13==d&&(e="e13"),14==d&&(e="eastdawnall"),d>=15&&18>=d&&(e="sbsm1518");break;case 2:e="A0610_ImgAnno",d>=11&&14>=d?e="B0530_eImgAnno":d>=15&&18>=d&&(e="siweiAnno68")}return f="",f=this.url,f+="?T=",f+=e,f+="&X="+b+"&Y="+c+"&L="+d},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TileLayer"}),Zondy.Object.AnyLine=OpenLayers.Class({Arcs:null,initialize:function(a){a&&0!=a.length&&(a[0]instanceof Zondy.Object.Arc&&(this.Arcs=a),a[0]instanceof Zondy.Object.Point2D&&(this.Arcs=[new Zondy.Object.Arc(a)]))}}),Zondy.Object.Arc=OpenLayers.Class({ArcID:0,Dots:null,initialize:function(a){this.Dots=a}}),Zondy.Object.FeatureGraphicBase=OpenLayers.Class({GID:0,initialize:function(){},setGID:function(a){this.GID=a}}),Zondy.Object.GLine=OpenLayers.Class(Zondy.Object.FeatureGraphicBase,{Line:null,initialize:function(a){this.Line=a}}),Zondy.Object.GRegion=OpenLayers.Class(Zondy.Object.FeatureGraphicBase,{Rings:null,initialize:function(a){a&&0!=a.length&&(a[0]instanceof Zondy.Object.AnyLine&&(this.Rings=a),a[0]instanceof Zondy.Object.Point2D&&(this.Rings=[new Zondy.Object.AnyLine(a)]))}}),Zondy.Object.CAttDataRow=OpenLayers.Class({FID:0,Values:null,initialize:function(a,b){this.FID=b,this.Values=a}}),Zondy.Object.CAttStruct=OpenLayers.Class({FldName:null,FldNumber:0,FldType:null,initialize:function(a){$.extend(this,a)}}),Zondy.Object.CLineInfo=OpenLayers.Class({Color:1,LinStyleID:1,LinStyleID2:0,LinWidth:1,Xscale:1,Yscale:1,initialize:function(a){OpenLayers.Util.extend(this,a)}}),Zondy.Object.CPointInfo=OpenLayers.Class({Angle:1,Color:1,SymHeight:1,SymID:1,SymWidth:1,initialize:function(a){OpenLayers.Util.extend(this,a)}}),Zondy.Object.CRegionInfo=OpenLayers.Class({EndColor:1,FillColor:1,FillMode:0,OutPenWidth:1,PatAngle:1,PatColor:1,PatHeight:1,PatID:1,PatWidth:1,initialize:function(a){OpenLayers.Util.extend(this,a)}}),Zondy.Object.CGDBInfo=OpenLayers.Class({GDBName:null,GDBSvrName:null,Password:null,User:null,initialize:function(a){$.extend(this,a)}}),Zondy.Object.CGetImageBySRSID=OpenLayers.Class({GdbInfo:null,SRSID:-1,initialize:function(a,b){this.GdbInfo=b,this.SRSID=a}}),Zondy.Object.DynShowStyle=OpenLayers.Class({Alpha:0,BugSpare:!1,CustomRender:!1,CustomRenderPath:null,DirectionLineClr:0,DynNoteFlag:!1,DynNoteInfo:null,IsShowArc:0,ISShowLineDirection:!1,LineInfo:null,MaxScale:0,MinScale:0,ShowCoordPnt:!1,SpareLineInfo:null,SparePointInfo:null,SpareRegInfo:null,SymbleScale:0,initialize:function(a){$.extend(this,a)}}),Zondy.Object.LabelLinInfo=OpenLayers.Class({ClientOutLabel:!1,DistFromLine:0,FromLineConstrain:0,Interval:0,LinType:0,Repeat:0,SpreadType:null,initialize:function(a){$.extend(this,a)}}),Zondy.Object.LabelPntInfo=OpenLayers.Class({Ang:null,ClientOutLabel:!1,Distance:0,EightDirLableType:null,PntType:0,initialize:function(a){$.extend(this,a)}}),Zondy.Object.LabelRegInfo=OpenLayers.Class({ClientOutLabel:!1,LabelMiniRegion:0,MayPlaceOutside:0,MiniRegionArea:0,Offset:0,RegType:0,initialize:function(a){$.extend(this,a)}}),Zondy.Object.CDisplayStyle=OpenLayers.Class({AnnSizeFixed:!1,DriverQuality:0,DynProjFlag:!1,FollowScale:!1,LinPenWidFixed:!1,LinSizeFixed:!1,PntPenWidFixed:!1,PntSizeFixed:!1,RegPenWidFixed:!1,RegSizeFixed:!1,ShowCoordPnt:!1,ShowElemRect:!1,ShowStyle:null,SymbleShow:!1,initialize:function(a){$.extend(this,a)}}),Zondy.Object.CDynNoteInfo=OpenLayers.Class({Angle:0,Backclr:0,Backexp:0,Bold:0,FieldName:null,FontAngle:0,FontColor:0,FontSize:0,FontStyle:0,Ifnt:0,Ifnx:0,IsFilled:!1,IsHzpl:!1,IsOvprnt:!1,LabelLevel:0,LableType:null,Offsetx:0,Offsety:0,Space:0,StrikeThrough:0,UnderLine:0,initialize:function(a){$.extend(this,a)}}),Zondy.Object.WebGraphicsInfo=OpenLayers.Class({InfoType:0,LinInfo:null,PntInfo:null,RegInfo:null,initialize:function(a){$.extend(this,a)}}),Zondy.Object.FeatureGeometry=OpenLayers.Class({LinGeom:null,PntGeom:null,RegGeom:null,initialize:function(a){$.extend(this,a)},setLine:function(a){this.LinGeom=a},setPntGeom:function(a){this.PntGeom=a},setRegGeom:function(a){this.RegGeom=a}}),Zondy.Object.Tangram=OpenLayers.Class({setByOL:function(){return null},toString:function(){return""},getGeometryType:function(){}}),Zondy.Object.Point2D=OpenLayers.Class(Zondy.Object.Tangram,{x:null,y:null,setByOL:function(a){this.x=a.x,this.y=a.y},toString:function(){if(null==this.x||null==this.y)return"";var a=this.x+","+this.y;return a},getGeometryType:function(){return"Point2D"},initialize:function(a,b){this.x=a,this.y=b}}),Zondy.Object.PointForQuery=OpenLayers.Class(Zondy.Object.Point2D,{initialize:function(){Zondy.Object.Point2D.prototype.initialize.apply(this,arguments)},nearDis:0,getGeometryType:function(){return"Point"},toString:function(){var a=Zondy.Object.Point2D.prototype.toString.apply(this);return a+";"+this.nearDis}}),Zondy.Object.Rectangle=OpenLayers.Class(Zondy.Object.Tangram,{xmin:0,xmax:0,ymin:0,ymax:0,setByOL:function(a){this.xmin=a.components[0].components[3].x,this.ymin=a.components[0].components[3].y,this.xmax=a.components[0].components[1].x,this.ymax=a.components[0].components[1].y},toString:function(){return""+this.xmin+","+this.ymin+","+this.xmax+","+this.ymax},getGeometryType:function(){return"Rect"},convertToBound:function(){return bounds=new OpenLayers.Bounds(this.xmin,this.ymin,this.ymax,this.xmax)},initialize:function(a,b,c,d){1==arguments.length&&(this.xmin=OpenLayers.Util.toFloat(a.split(",")[0]),this.ymin=OpenLayers.Util.toFloat(a.split(",")[1]),this.xmax=OpenLayers.Util.toFloat(a.split(",")[2]),this.ymax=OpenLayers.Util.toFloat(a.split(",")[3])),4==arguments.length&&(this.xmin=a,this.ymin=b,this.xmax=c,this.ymax=d)}}),Zondy.Object.Feature=OpenLayers.Class({AttValue:null,FID:0,bound:null,fGeom:null,ftype:0,GraphicInfo:null,initialize:function(a){$.extend(this,a)},getAttValue:function(a){if(null===this.AttValue)return null;var b=this.AttValue.length;return"number"==typeof a?a>=b?null:this.AttValue[a]:void 0},getGraphicInfo:function(){return null===this.GraphicInfo?null:new Zondy.Object.WebGraphicsInfo(this.GraphicInfo)},getAttValueArray:function(){return this.AttValue},getRectBound:function(){var a=this.bound;return null!=a?new Zondy.Object.Rectangle(a):a},getGeometry:function(){},getFID:function(){return this.FID},setAttValues:function(a){this.AttValue=a},setBound:function(a){var b=null;"string"==typeof a&&(b=new Zondy.Object.Rectangle(a)),a instanceof String&&(b=new Zondy.Object.Rectangle(a)),a instanceof Zondy.Object.Rectangle&&(b=a),a instanceof OpenLayers.Geometry.Rectangle&&(b=new Zondy.Object.Rectangle,b.setByOL(a)),this.bound=b},setFID:function(a){this.FID=a},setFType:function(a){this.ftype=a}}),Zondy.Object.FeatureSet=OpenLayers.Class({AttStruct:null,SFEleArray:new Array,TotalCount:0,initialize:function(){},clear:function(){this.AttStruct=null,this.SFEleArray=new Array},addFeature:function(a){a instanceof Array?this.SFEleArray.concat(a):this.SFEleArray.push(a)},getFeaturesLength:function(){return this.SFEleArray instanceof Array?this.SFEleArray.length:0},getFeatureByIndex:function(a){if(a>=this.getFeaturesLength())return null;var b=this.SFEleArray[a];return b instanceof Zondy.Object.Feature?b:new Zondy.Object.Feature(this.SFEleArray[a])},getAttType:function(a){var b;return null==this.AttStruct?null:(b="number"==typeof a?a:this.getAttIndexByAttName(a),null==b?null:this.AttStruct.FldType[b])},getAttIndexByAttName:function(a){var b,c;if(null==this.AttStruct)return null;if(null==this.AttStruct.FldName)return null;for(b=this.AttStruct.FldName.length,c=0;b>c;c++)if(this.AttStruct.FldName[c]==a)return c;return null},getAttNameByIndex:function(a){return null==this.AttStruct?null:null==this.AttStruct.FldName?null:this.AttStruct.FldName.length<=a?null:this.AttStruct.FldName[a]}}),Zondy.Object.GPoint=OpenLayers.Class(Zondy.Object.FeatureGraphicBase,{Dot:null,initialize:function(a,b){this.Dot=new Zondy.Object.Point2D(a,b)},setDot:function(a){this.Dot=a}}),Zondy.Object.Circle=OpenLayers.Class(Zondy.Object.Tangram,{point:null,radious:null,setByOL:function(a){var b=a.components,c=new OpenLayers.Geometry.LinearRing(b[0].components),d=c.getCentroid(),e=Math.abs(b[0].components[0].x-d.x);this.point=new Zondy.Object.Point2D(d.x,d.y),this.radious=e},toString:function(){return null==this.point||null==this.radious?"":this.point.x+","+this.point.y+","+this.radious},getGeometryType:function(){return"Circle"},initialize:function(a,b){this.point=a,this.radious=b}}),Zondy.Object.Polygon=OpenLayers.Class(Zondy.Object.Tangram,{pointArr:null,setByOL:function(a){var c,b=a.components[0].components.length;for(c=0;b>c;c++)this.pointArr[c]=new Zondy.Object.Point2D(a.components[0].components[c].x,a.components[0].components[c].y)},toString:function(){var a,b;if(null==this.pointArr||0==this.pointArr.length)return"";for(b="",a=0;a<this.pointArr.length;a++)b+=this.pointArr[a].x+","+this.pointArr[a].y+",";return b.substring(0,b.length-1)},getGeometryType:function(){return"Polygon"},initialize:function(a){this.pointArr=new Array,void 0!=a&&(this.pointArr=a)}}),Zondy.Object.PolyLine=OpenLayers.Class(Zondy.Object.Tangram,{pointArr:null,setByOL:function(a){var c,b=a.components[0].components.length;for(c=0;b>c;c++)this.pointArr[c]=new Zondy.Object.Point2D(a.components[0].components[c].x,a.components[0].components[c].y)},toString:function(){var a,b;if(null==this.pointArr||0==this.pointArr.length)return"";for(b="",a=0;a<this.pointArr.length;a++)b+=this.pointArr[a].x+","+this.pointArr[a].y+",";return b.substring(0,b.length-1)},getGeometryType:function(){return"Line"},initialize:function(a){this.pointArr=new Array,void 0!=a&&(this.pointArr=a)}}),Zondy.Object.PolyLineForQuery=OpenLayers.Class(Zondy.Object.PolyLine,{initialize:function(){Zondy.Object.PolyLine.prototype.initialize.apply(this,arguments)},nearDis:0,toString:function(){var a=Zondy.Object.PolyLine.prototype.toString.apply(this);return a+";"+this.nearDis}}),Zondy.Service.AnalysisBase=OpenLayers.Class(Zondy.Service.HttpRequest,{flowID:null,initialize:function(){},execute:function(a,b,c,d){var f,g,h,i,e={};if(void 0===b&&(b="get"),void 0==d?d="json":"xml"!=d.toLowerCase()&&(d="json"),void 0==c&&(c=!1),null==this.partUrl&&(this.partUrl="execute/"+this.flowID),null==this.baseUrl&&(this.baseUrl="igs/rest/mrfws"),"get"==b.toLowerCase()&&(e.f=d,e.isAsy=c,f=$.toJSON(this,["port","ip","baseUrl","partUrl"],";",!1),e.paraValues=f.substring(1,f.length-1)),"post"==b.toLowerCase()){this.partUrl+="?isAsy="+c.toString()+"&f="+d,f=$.toJSON(this,["port","ip","baseUrl","partUrl"],","),g=$.parseJSON(f),h={},i=new Array;for(o in g)h.Key=o,h.Key=g[o].toString(),i.push(h);e=$.toJSON(i)}this.ajax(null,e,a,b,null,d)}}),Zondy.Service.ClassBufferBase=OpenLayers.Class(Zondy.Service.AnalysisBase,{srcInfo:null,desInfo:null,idstr:"1,2,3,4,5",angleType:0,isDissolve:!0,isDynPrj:!1,initialize:function(a,b){$.extend(this,a,b)}}),Zondy.Service.ClassBufferByMultiplyRing=OpenLayers.Class(Zondy.Service.ClassBufferBase,{radiusStr:"2,4,8,10",initialize:function(){this.flowID="600232",Zondy.Service.ClassBufferBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ClassBufferBySingleRing=OpenLayers.Class(Zondy.Service.ClassBufferBase,{leftRad:5,rightRad:5,isByAtt:!1,fldName:null,dynPrjRad:0,initialize:function(){this.flowID="600231",Zondy.Service.ClassBufferBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ClipBase=OpenLayers.Class(Zondy.Service.AnalysisBase,{desInfo:null,attOptType:1,infoOptType:1,overType:3,tolerance:1e-4,isCleanNode:!1,isLabelPnt:!1,isValidReg:!1,initialize:function(a,b){$.extend(this,a,b)}}),Zondy.Service.ClipByCircle=OpenLayers.Class(Zondy.Service.ClipBase,{srcInfo:null,center:null,radius:null,step:.001,initialize:function(){this.flowID="600229",Zondy.Service.ClipBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ClipByLayer=OpenLayers.Class(Zondy.Service.ClipBase,{srcInfo1:null,srcInfo2:null,initialize:function(){this.flowID="600230",Zondy.Service.ClipBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ClipByPolygon=OpenLayers.Class(Zondy.Service.ClipBase,{srcInfo:null,strPos:null,initialize:function(){this.flowID="600228",Zondy.Service.ClipBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.FeatureBuffBase=OpenLayers.Class(Zondy.Service.AnalysisBase,{sfGeometryXML:null,attStrctXML:null,attRowsXML:null,traceRadius:1e-4,resultName:null,inFormat:"json",initialize:function(a,b){$.extend(this,a,b)}}),Zondy.Service.FeatureBuffByMultiplyRing=OpenLayers.Class(Zondy.Service.FeatureBuffBase,{radiusStr:"0.003,0.002,0.001",initialize:function(){this.flowID="600239",Zondy.Service.FeatureBuffBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.FeatureBuffBySingleRing=OpenLayers.Class(Zondy.Service.FeatureBuffBase,{leftRad:.001,rightRad:.001,initialize:function(){this.flowID="600238",Zondy.Service.FeatureBuffBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.GeometryAnalysisBase=OpenLayers.Class(Zondy.Service.HttpRequest,{resultFormat:"json",initialize:function(){null==this.baseUrl&&(this.baseUrl="igs/rest/mrgs/geomservice")}}),Zondy.Service.CalServiceBase=OpenLayers.Class(Zondy.Service.GeometryAnalysisBase,{dots:null,projectInfo:null,projectInfoBySRSID:null,initialize:function(a,b){this.dots=a,$.extend(this,b),Zondy.Service.GeometryAnalysisBase.prototype.initialize.apply(this)},execute:function(a,b){a instanceof Zondy.Service.CProjectParam&&(this.projectInfo=a),a instanceof Zondy.Service.CProjectBySRSID&&(this.projectInfoBySrsID=a);var c={};c.Dots=this.dots,c.ProjectInfo=this.projectInfo,c.ProjectInfoBySrsID=this.projectInfoBySrsID,$.toJSON(c),this.ajax(null,c,b,"POST")}}),Zondy.Service.CProjectBySRSID=OpenLayers.Class({DesSrsID:null,GdbInfo:null,initialize:function(a,b){this.DesSrsID=a,this.GdbInfo=b}}),Zondy.Service.CProjectParam=OpenLayers.Class({ProjAngleUnit:0,ProjLat:0,ProjLat1:0,ProjLat2:0,ProjLon:0,ProjRate:0,ProjType:0,ProjTypeID:0,ProjUnit:0,ProjZoneNO:0,ProjZoneType:0,SphereID:0,initialize:function(a){$.extend(this,a)}}),Zondy.Service.CProjectDots=OpenLayers.Class({DesProjParm:null,SrcProjParam:null,InputDots:null,initialize:function(a){$.extend(this,a)}}),Zondy.Service.CalPolyLineLength=OpenLayers.Class(Zondy.Service.CalServiceBase,{initialize:function(){this.partUrl="calLength?f="+this.resultFormat,Zondy.Service.CalServiceBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.CalArea=OpenLayers.Class(Zondy.Service.CalServiceBase,{initialize:function(){this.partUrl="calArea?f="+this.resultFormat,Zondy.Service.CalServiceBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ProjectDots=OpenLayers.Class(Zondy.Service.GeometryAnalysisBase,{initialize:function(){Zondy.Service.GeometryAnalysisBase.prototype.initialize.apply(this)},execute:function(a,b){this.partUrl="projectdots?f="+this.resultFormat;var c=$.toJSON(a);this.ajax(null,c,b,"POST")}}),Zondy.Service.TopAnalysis=OpenLayers.Class(Zondy.Service.GeometryAnalysisBase,{pnt:null,line:null,reg:null,nearDis:.01,relativeObj:null,p_onSuccess:null,initialize:function(a){$.extend(this,a),Zondy.Service.GeometryAnalysisBase.prototype.initialize.apply(this)},setPnt:function(a){this.pnt=a},setLine:function(a){this.line=a},setReg:function(a){this.reg=a},setRelativeObj:function(a){this.relativeObj=a},execute:function(a){var b,c;this.p_onSuccess=a,b={},b.NearDis=this.nearDis,b.Pnt=this.pnt,b.Line=this.line,b.Reg=this.reg,b.RelativeObj=this.relativeObj,this.partUrl="topanalysis?f="+this.resultFormat,c=$.toJSON(b),this.ajax(null,c,this.onGetRltSuccess,"POST")},onGetRltSuccess:function(a){var b=Zondy.Util.getTopAnalysisResult(a);this.p_onSuccess(b)}}),Zondy.Service.NetAnalysis=OpenLayers.Class(Zondy.Service.AnalysisBase,{netClsUrl:null,flagPosStr:null,analyTp:"UserMode",weight:",Weight1,Weight1",outFormat:"JSON",elementType:2,nearDis:.001,barrierPosStr:null,initialize:function(a,b){this.flowID="600233",$.extend(this,a,b)}}),Zondy.Service.OverlayBase=OpenLayers.Class(Zondy.Service.AnalysisBase,{srcInfo1:null,desInfo:null,attOptType:1,infoOptType:1,overType:1,isCleanNode:!1,isLabelPnt:!1,isValidReg:!1,isReCalculate:!0,radius:.001,initialize:function(a,b){$.extend(this,a,b)}}),Zondy.Service.OverlayByLayer=OpenLayers.Class(Zondy.Service.OverlayBase,{srcInfo2:null,initialize:function(){this.flowID="600227",Zondy.Service.OverlayBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.OverlayByPolygon=OpenLayers.Class(Zondy.Service.OverlayBase,{strGRegionXML:null,inFormat:"json",initialize:function(){this.flowID="600237",Zondy.Service.OverlayBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ProjectBase=OpenLayers.Class(Zondy.Service.AnalysisBase,{clsName:null,desClsName:null,initialize:function(a,b){$.extend(this,a,b)}}),Zondy.Service.ProjectByLayer=OpenLayers.Class(Zondy.Service.ProjectBase,{projTypeID:5,sphereType:2,projAngleUnit:4,projType:3,projZoneType:1,projZoneNO:20,projLon:117e4,projLat:0,projLat1:0,projLat2:0,projUnit:2,projRate:1,x:0,y:0,initialize:function(){this.flowID="600235",Zondy.Service.ProjectBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.ProjectBySRID=OpenLayers.Class(Zondy.Service.ProjectBase,{srID:32,initialize:function(){this.flowID="600234",Zondy.Service.ProjectBase.prototype.initialize.apply(this,arguments)}}),Zondy.Service.Catalog.CatalogServiceBase=OpenLayers.Class(Zondy.Service.HttpRequest,{resultFormat:"json",initialize:function(){null==this.baseUrl&&(this.baseUrl="igs/rest/mrcs")}}),Zondy.Service.Catalog.IncludeStruct=OpenLayers.Class({includeDetails:!0,includeSubs:!0,initialize:function(a,b){a instanceof Boolean&&(this.includeDetails=a),b instanceof Boolean&&(this.includeSubs=b)},toJSON:function(){return $.toJSON(this)}}),Zondy.Service.Catalog.MapDoc=OpenLayers.Class(Zondy.Service.Catalog.CatalogServiceBase,{docName:null,mapIndex:0,layerID:0,setDocName:function(a){this.docName=a},setMapIndex:function(a){this.mapIndex=a},setLayerID:function(a){this.layerID=a},initialize:function(a){$.extend(this,a),Zondy.Service.Catalog.CatalogServiceBase.prototype.initialize.apply(this)},getMapDocList:function(a){this.partUrl="docs?f="+this.resultFormat,this.ajax(null,null,a)},getMapDocInfo:function(a,b,c){this.partUrl="docs/"+this.docName+"?f="+this.resultFormat;var d=new Zondy.Service.Catalog.IncludeStruct(b,c);this.partUrl+="&include="+d.toJSON(),this.ajax(null,null,a)},getMapInfo:function(a,b,c){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"?f="+this.resultFormat;var d=new Zondy.Service.Catalog.IncludeStruct(b,c);this.partUrl+="&include="+d.toJSON(),this.ajax(null,null,a)},getLayersInfo:function(a){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"/layers?f="+this.resultFormat,this.ajax(null,null,a)},getLayerInfo:function(a){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"/"+this.layerID+"?f="+this.resultFormat,this.ajax(null,null,a)},deleteLayer:function(a){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"/layers/delete?f="+this.resultFormat+"&layerIDs="+this.layerID,this.ajax(null,null,a)},addLayer:function(a,b){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"/layers/add?f="+this.resultFormat,this.ajax(null,a,b,"POST")},createDoc:function(a,b){this.partUrl="docs//create?f="+this.resultFormat,this.ajax(null,a,b,"POST")},changeIndex:function(a,b){this.partUrl="docs/"+this.docName+"/"+this.mapIndex+"/layers/index?f="+this.resultFormat,this.ajax(null,a,b,"POST")}}),Zondy.Map.Layer=OpenLayers.Class(OpenLayers.Layer.Grid,Zondy.Service.HttpRequest,{gdbps:null,f:"png",style:null,filters:null,singleTile:!0,initialize:function(a,b,c){var d,e,f;this.gdbps=b,null==this.baseUrl&&(this.baseUrl="igs/rest/mrms"),null==this.partUrl&&(this.partUrl="layers"),OpenLayers.Util.extend(this,c),d="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/"+this.partUrl,e=[],f={},e.push(a,d,f,{}),OpenLayers.Layer.Grid.prototype.initialize.apply(this,e)},getURL:function(a){var b,c,d;return a=this.adjustBounds(a),b={},c=this.getImageSize(),b.bbox=this.encodeBBOX?a.toBBOX(null):a.toArray(),b.w=c.w,b.h=c.h,b.style=this.style,b.filters=this.filters,d="",$.each(this.gdbps,function(a,b){d+=","+b}),b.gdbps=d.substring(1,d.length),this.getFullRequestString(b)}}),Zondy.Service.EditServiceBase=OpenLayers.Class(Zondy.Service.HttpRequest,{resultFormat:"json",initialize:function(){this.baseUrl="igs/rest/mrfs"},getFullUrl:function(){var a="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/"+this.partUrl;return a},getBaseUrl:function(){var a="http://"+this.ip+":"+this.port+"/"+this.baseUrl+"/";return a}}),Zondy.Service.EditDocFeature=OpenLayers.Class(Zondy.Service.EditServiceBase,Zondy.Service.DocLayer,{initialize:function(a,b,c){$.extend(this,c),this.docName=a,this.layerIndex=b,this.partUrl="docs/"+this.docName+"/"+this.mapIndex.toString()+"/"+this.layerIndex.toString(),Zondy.Service.EditServiceBase.prototype.initialize.apply(this)
},add:function(a,b){this.partUrl+="/addFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat;this.ajax(c,a,b,"POST")},update:function(a,b){this.partUrl+="/updateFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat;this.ajax(c,a,b,"POST")},deletes:function(a,b){this.partUrl+="/deleteFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat+"&objectIds="+a;this.ajax(c,null,b,"POST")}}),Zondy.Service.EditLayerFeature=OpenLayers.Class(Zondy.Service.EditServiceBase,{gdbp:null,initialize:function(a,b){$.extend(this,b),this.gdbp=a,this.partUrl="layer",Zondy.Service.EditServiceBase.prototype.initialize.apply(this)},add:function(a,b){this.partUrl+="/addFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat+"&gdbp="+this.gdbp;this.ajax(c,a,b,"POST")},update:function(a,b){this.partUrl+="/updateFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat+"&gdbp="+this.gdbp;this.ajax(c,a,b,"POST")},deletes:function(a,b){this.partUrl+="/deleteFeatures";var c=this.getFullUrl()+"?f="+this.resultFormat+"&objectIds="+a+"&gdbp="+this.gdbp;this.ajax(c,null,b,"POST")}}),Zondy.Service.Catalog.VectorLayer=OpenLayers.Class(Zondy.Service.Catalog.CatalogServiceBase,{serverName:"MapGISLocal",gdbName:null,dsName:null,setServerName:function(a){this.serverName=a},setGdbName:function(a){this.gdbName=a},setDsName:function(a){this.dsName=a},initialize:function(a){OpenLayers.Util.extend(this,a),Zondy.Service.Catalog.CatalogServiceBase.prototype.initialize.apply(this)},getServerList:function(a){this.partUrl="datasource?f="+this.resultFormat,this.ajax(null,null,a)},getServerGDBList:function(a){this.partUrl="datasource/"+this.serverName+"?f="+this.resultFormat,this.ajax(null,null,a)},getSfclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/sfcls?f="+this.resultFormat,this.ajax(null,null,a)},getFclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/fcls?f="+this.resultFormat,this.ajax(null,null,a)},getAclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/acls?f="+this.resultFormat,this.ajax(null,null,a)},getNclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/ncls?f="+this.resultFormat,this.ajax(null,null,a)},getDsSfclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/sfcls?f="+this.resultFormat,this.ajax(null,null,a)},getDsAclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/acls?f="+this.resultFormat,this.ajax(null,null,a)},getDsOclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/ocls?f="+this.resultFormat,this.ajax(null,null,a)},getDsNclsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/ncls?f="+this.resultFormat,this.ajax(null,null,a)},getDsRdsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/rds?f="+this.resultFormat,this.ajax(null,null,a)},getDsRcsList:function(a){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/rcs?f="+this.resultFormat,this.ajax(null,null,a)},getLayerList:function(a,b){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+b+"?f="+this.resultFormat,this.ajax(null,null,a)},getLayerListInDS:function(a,b){this.partUrl="datasource/"+this.serverName+"/"+this.gdbName+"/"+this.dsName+"/"+b+"?f="+this.resultFormat,this.ajax(null,null,a)}}),Zondy.Service.QueryServiceBase=OpenLayers.Class(Zondy.Service.HttpRequest,{resultCallBack:null,processResult:function(a){var b=new Zondy.Object.FeatureSet;$.extend(b,a),this.resultCallBack(b)},queryParam:null,initialize:function(){this.baseUrl="igs/rest/mrfs/"},query:function(a){var b,c;null!=this.queryParam&&(b="",this.queryParam instanceof Zondy.Service.QueryParameter&&(b="http://"+this.ip+":"+this.port+"/"+this.baseUrl+this.partUrl,c=this.queryParam.getParameterObject(),this.restQuery(b,c,a)))},restQuery:function(a,b,c){this.resultCallBack=c,this.ajax(a,b,this.processResult,"GET",null,b.f)}}),Zondy.Service.QueryFeatureStruct=OpenLayers.Class({IncludeAttribute:!0,IncludeGeometry:!1,IncludeWebGraphic:!1,toJSON:function(){return $.toJSON(this)},initialize:function(a){$.extend(this,a)}}),Zondy.Service.QueryParameterBase=OpenLayers.Class({geometry:null,where:null,rule:null,objectIds:null,pageIndex:0,recordNumber:20,resultFormat:"json",struct:null,initialize:function(){null==this.struct&&(this.struct=new Zondy.Service.QueryFeatureStruct)}}),Zondy.Service.QueryFeatureRule=OpenLayers.Class({CompareRectOnly:!1,EnableDisplayCondition:!1,MustInside:!1,Intersect:!1,toJSON:function(){return $.toJSON(this)},initialize:function(a){$.extend(this,a)}}),Zondy.Service.QueryDocFeature=OpenLayers.Class(Zondy.Service.QueryServiceBase,Zondy.Service.DocLayer,{onSuccess:null,initialize:function(a,b,c,d){$.extend(this,d),this.queryParam=a,this.mapName=b,this.layerIndex=c,this.partUrl="docs/"+this.mapName+"/"+this.mapIndex.toString()+"/"+this.layerIndex+"/query",Zondy.Service.QueryServiceBase.prototype.initialize.apply(this)},query:function(a){var b,c;null!=this.queryParam&&(b="",this.queryParam instanceof Zondy.Service.QueryParameter&&(b="http://"+this.ip+":"+this.port+"/"+this.baseUrl+this.partUrl,c=this.queryParam.getParameterObject(),this.restQuery(b,c,a)))}}),Zondy.Service.QueryLayerFeature=OpenLayers.Class(Zondy.Service.QueryServiceBase,{initialize:function(a,b){$.extend(this,b),this.queryParam=a,this.partUrl="layer/query",Zondy.Service.QueryServiceBase.prototype.initialize.apply(this)}}),Zondy.Service.QueryParameter=OpenLayers.Class(Zondy.Service.QueryParameterBase,{getParameterURL:function(){var a="";return a="geometry="+this.geometry.toString(),a+="&geometryType="+this.geometry.getGeometryType(),a+="&page="+this.pageIndex.toString(),a+="&pageCount="+this.recordNumber.toString(),a+="&f="+this.resultFormat,null!=this.struct&&(a+="&structs="+$.toJSON(this.struct)),null!=this.where&&(a+="&where="+this.where),null!=this.rule&&(a+="&rule="+$.toJSON(this.rule)),null!=this.objectIds&&(a+="&objectIds="+this.objectIds),a},getParameterObject:function(){var a={};return a.f=this.resultFormat,null!=this.struct&&(a.structs=this.struct.toJSON()),null!=this.objectIds?(a.objectIds=this.objectIds,a):(a.page=this.pageIndex.toString(),a.pageCount=this.recordNumber.toString(),null!=this.geometry&&(a.geometry=this.geometry.toString(),a.geometryType=this.geometry.getGeometryType()),null!=this.where&&(a.where=this.where),null!=this.rule&&(a.rule=this.rule.toJSON()),a)},initialize:function(a){this.struct=new Zondy.Service.QueryFeatureStruct,OpenLayers.Util.extend(this,a)}}),Zondy.Service.QueryByLayerParameter=OpenLayers.Class(Zondy.Service.QueryParameter,{gdbp:null,getParameterURL:function(){var a=Zondy.Service.QueryParameter.prototype.getParameterURL.apply(this);return a+"&gdbp="+this.gdbp},getParameterObject:function(){var a=Zondy.Service.QueryParameter.prototype.getParameterObject.apply(this);return a.gdbp=this.gdbp,a},initialize:function(a,b){this.struct=new Zondy.Service.QueryFeatureStruct,this.gdbp=encodeURI(a),OpenLayers.Util.extend(this,b)}}),Zondy.Service.Catalog.CAddMapLayerInfo=OpenLayers.Class({Index:0,LayerName:null,GDBP:null,initialize:function(a,b,c){this.Index=b,this.LayerName=a,this.GDBP=c}}),Zondy.Service.Catalog.CAddMapGroupInfo=OpenLayers.Class({GroupName:null,Index:0,AddMapLayerInfos:null,initialize:function(a,b,c){this.GroupName=a,this.Index=b,this.AddMapLayerInfos=c}}),Zondy.Service.Catalog.CAddMapInfo=OpenLayers.Class({MapName:null,Index:0,LayerInfos:null,GroupInfos:null,initialize:function(a,b,c){this.MapName=a,this.LayerInfos=b,$.extend(this,c)}}),Zondy.Service.Catalog.CAddDocInfo=OpenLayers.Class({CreatFolderNode:!1,DocName:null,IsRelease:!1,AddMapInfos:null,initialize:function(a,b,c){this.DocName=a,this.AddMapInfos=b,$.extend(this,c)}}),Zondy.Format.PolygonJSON=OpenLayers.Class(OpenLayers.Format.JSON,{read:function(a){var d=null;return d="string"==typeof a?OpenLayers.Format.JSON.prototype.read.apply(this,[a]):a,d||OpenLayers.Console.error("Bad JSON:"+a),this.parseVectors(d)},parseVectors:function(a){var c,d,e,f,g,h,b=[];if(!a)return null;if(!a.SFEleArray)return null;for(c=a.SFEleArray.length,d=0;c>d;d++)e=a.SFEleArray[d],f=this.parseAttribute(a.AttStruct,e.AttValue),g=this.parseGeometry(e.fGeom,e.ftype),h=new OpenLayers.Feature.Vector(g,f,null),h.fid=e.FID.toString(),h.bounds=this.parseBound(e.bound),b[d]=h;return b},parseBound:function(a){if(!a)return null;var b=new OpenLayers.Bounds(a.xmin,a.ymin,a.xmax,a.ymax);return b},parseAttribute:function(a,b){var d,e,f,c={};if(!a&&!b)return null;if(d=a.FldName.length,e=b.length,d!=e)return null;for(f=0;d>f;f++)c[a.FldName[f]]=b[f];return c},parseGeometry:function(a,b){var c;switch(b){case 1:c=null;break;case 2:c=this.parseGLine(a.LinGeom);break;case 3:c=this.parseGRegion(a.RegGeom)}return c},parseGRegion:function(a){var b,d,e,f,g,h,i,j,k,c=[];if(!a)return null;if(b=a.length,0===b)return null;if(d=a[0],!d)return null;for(e=d.Rings.length,f=0;e>f;f++){for(g=d.Rings[f],h=[],i=g.Arcs[0].Dots,j=i.length,f=0;j>f;f++)k=new OpenLayers.Geometry.Point(i[f].x,i[f].y),h[f]=k;c[f]=new OpenLayers.Geometry.LinearRing(h)}return new OpenLayers.Geometry.Polygon(c)},parseGLine:function(a){var b,d,e,f,g,h,i,c=[];if(!a)return null;if(b=a.length,0===b)return null;for(d=0;b>d;d++){for(e=[],f=a[d].Line.Arcs[0].Dots,g=f.length,h=0;g>h;h++)i=new OpenLayers.Geometry.Point(f[h].x,f[h].y),e[h]=i;c[d]=new OpenLayers.Geometry.LinearRing(e)}return new OpenLayers.Geometry.Polygon(c)}});